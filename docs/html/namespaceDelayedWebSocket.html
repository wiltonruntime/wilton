<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>wilton.js: DelayedWebSocket Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">wilton.js
   &#160;<span id="projectnumber">v202002231</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Packages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="namespacemembers.html"><span>Package&#160;Functions</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">DelayedWebSocket Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><b>wilton/DelayedWebSocket</b> <br/>
 Send WebSocket message to client from another thread  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a209de63d90050b6052a00da4a6a82a7d"><td class="memItemLeft" align="right" valign="top">Undefined&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDelayedWebSocket.html#a209de63d90050b6052a00da4a6a82a7d">close</a> (Function|Undefined callback)</td></tr>
<tr class="memdesc:a209de63d90050b6052a00da4a6a82a7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close WebSocket.  <a href="#a209de63d90050b6052a00da4a6a82a7d"></a><br/></td></tr>
<tr class="memitem:a5e69dd54888d97622d63c33604bbd564"><td class="memItemLeft" align="right" valign="top">Object&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDelayedWebSocket.html#a5e69dd54888d97622d63c33604bbd564">DelayedWebSocket</a> (Number webSocketHandle, Function|Undefined callback)</td></tr>
<tr class="memdesc:a5e69dd54888d97622d63c33604bbd564"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create <code><a class="el" href="namespaceDelayedWebSocket.html" title="wilton/DelayedWebSocket   Send WebSocket message to client from another thread">DelayedWebSocket</a></code> instance.  <a href="#a5e69dd54888d97622d63c33604bbd564"></a><br/></td></tr>
<tr class="memitem:a5f79289d112ef1515608ca0605225123"><td class="memItemLeft" align="right" valign="top">Undefined&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceDelayedWebSocket.html#a5f79289d112ef1515608ca0605225123">send</a> (String|Object data, Object|Undefined options, Function|Undefined callback)</td></tr>
<tr class="memdesc:a5f79289d112ef1515608ca0605225123"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send string or JSON message to client and release WebSocket.  <a href="#a5f79289d112ef1515608ca0605225123"></a><br/></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This module allows to send a "delayed" WebSocket message to client. To create a <code><a class="el" href="namespaceDelayedWebSocket.html" title="wilton/DelayedWebSocket   Send WebSocket message to client from another thread">DelayedWebSocket</a></code> instance, first <code>webSocketHandle</code> needs to be obtained inside the <code><a class="el" href="namespaceServer.html" title="wilton/Server   HTTP server.">Server</a></code> request handler (view) using the <code>req.retainWebSocket()</code>function.</p>
<p><code><a class="el" href="namespaceDelayedWebSocket.html" title="wilton/DelayedWebSocket   Send WebSocket message to client from another thread">DelayedWebSocket</a></code> may be created from any thread specifying the <code>webSocketHandle</code> as an argument.</p>
<p>Usage example:</p>
<div class="fragment"><div class="line"><span class="comment">// inside server request handler</span></div>
<div class="line">GET: <span class="keyword">function</span>(req) {</div>
<div class="line">    <span class="comment">// delay sending a response</span></div>
<div class="line">    <span class="comment">// and release the current worker thread</span></div>
<div class="line">    <span class="comment">// creating a webSocketHandle</span></div>
<div class="line">    var handle = req.retainWebSocket();</div>
<div class="line"></div>
<div class="line">    <span class="comment">// pass the handle to other thread using some channel</span></div>
<div class="line">    chan.send({</div>
<div class="line">        handle: handle</div>
<div class="line">    });</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// in other thread</span></div>
<div class="line">var obj = chan.receive();</div>
<div class="line">var writer = <span class="keyword">new</span> <a class="code" href="namespaceDelayedWebSocket.html#a5e69dd54888d97622d63c33604bbd564" title="Create DelayedWebSocket instance.">DelayedWebSocket</a>(obj.handle);</div>
<div class="line">writer.send({</div>
<div class="line">    foo: <span class="stringliteral">&quot;bar&quot;</span></div>
<div class="line">});</div>
</div><!-- fragment --> </div><h2>Function Documentation</h2>
<a class="anchor" id="a209de63d90050b6052a00da4a6a82a7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Undefined DelayedWebSocket::close </td>
          <td>(</td>
          <td class="paramtype">Function|Undefined&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Closes this WebSocket.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td><code>Function|Undefined</code> callback to receive result or error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>Undefined</code> </dd></dl>

</div>
</div>
<a class="anchor" id="a5e69dd54888d97622d63c33604bbd564"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Object DelayedWebSocket::DelayedWebSocket </td>
          <td>(</td>
          <td class="paramtype">Number&#160;</td>
          <td class="paramname"><em>webSocketHandle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Function|Undefined&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates <code><a class="el" href="namespaceDelayedWebSocket.html" title="wilton/DelayedWebSocket   Send WebSocket message to client from another thread">DelayedWebSocket</a></code> object instance that can be used to send WebSocket message to client from the different thread.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">webSocketHandle</td><td><code>Number</code> handle value, that must be obtained inside request handler (view) using <code>req.retainWebSocket()</code> call and (optionally) be passed to another thread after that </td></tr>
    <tr><td class="paramname">callback</td><td><code>Function|Undefined</code> callback to receive result or error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>Object</code> <code><a class="el" href="namespaceDelayedResponse.html" title="wilton/DelayedResponse   Send HTTP response to client from another thread">DelayedResponse</a></code> instance </dd></dl>

</div>
</div>
<a class="anchor" id="a5f79289d112ef1515608ca0605225123"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Undefined DelayedWebSocket::send </td>
          <td>(</td>
          <td class="paramtype">String|Object&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Object|Undefined&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Function|Undefined&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sends message to client converting specified object into JSON if necessary. After this call previously retained WebSocket is released (this object cannot be used anymore) and continues to process incoming messages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td><code>String|Object</code> response body, object will be converted to JSON </td></tr>
    <tr><td class="paramname">options</td><td><code>Object|Undefined</code> configuration object, currently not used </td></tr>
    <tr><td class="paramname">callback</td><td><code>Function|Undefined</code> callback to receive result or error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>Undefined</code> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Feb 23 2020 23:12:24 for wilton.js by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
